angular.module("JavaApp",["ui.bootstrap","ngSanitize","ui.keypress"]).config(["$locationProvider",function(e){e.html5Mode(true)}]).service("AutoCompleteService",["$http",function(e){var t=function(e,t){t=t||"java";return"rest/autoComplete/index?str="+e+"&index="+t};this.get=function(n,r){return e.get(t(n,r)).error(function(e,t,r,i){alert("AutoCompleteService.get("+n+") didn't work: "+t+": "+e)})}}]).service("DbService",["$http","$rootScope","Log",function(e,t,n){var r=this;this.logging={prefix:"DbService"};var i=function(e){n.log(r,"onSuccess: ");t.$emit("$saJavadocModelChange",e)};var s=function(e){return"rest"+e};var o=function(t){t=t.replace(/\?/g,"%3F");n.log(this,"get: "+t);return e.get(s(t)).success(i).error(function(e,n,r,i){alert("DbService.get("+t+") didn't work: "+n+": "+e)})};var u=function(t){t=t.replace(/\?/g,"%3F");n.log(this,"getQuietly: "+t);return e.get(s(t)).error(function(e,n,r,i){alert("DbService.get("+t+") didn't work: "+n+": "+e)})};this.get=o;this.getQuietly=u}]).factory("Formatter",["_","Utils","JavadocModelUtils","Log",function(e,t,n,r){var i=t.isEmpty;var s=this;var o=function(t){return i(t)?"":"&lt;"+e.map(t,h).join(", ")+"&gt;"};var u=function(e){return n.isMethod(e)?n.getQualifiedName(e):n.getNameAndDimension(e)};var a=function(e){return"<a href='#"+e._id+"'>"+u(e)+"</a>"};var f=function(e){return"<a href='#/q/java/qn/"+n.getReferenceName(e)+"'>"+u(e)+"</a>"};var l=function(e){var t="<span title="+c(n.getQualifiedName(e))+">";if(e._id){t+=a(e)}else if(!n.isPrimitiveType(e)){t+=f(e)}else{t+=u(e)}t+="</span>";return t};var c=function(e){return"'"+e+"'"};var h=function(e){if(i(e)){return""}var t=l(e);if(!i(e.parameterizedType)){t+=o(e.parameterizedType.typeArguments)}else if(!i(e.wildcardType)){t+=d(e.wildcardType.extendsBounds);t+=p(e.wildcardType.superBounds)}return t};var p=function(t){return i(t)?"":" super "+e.map(t,h).join(" & ")};var d=function(t){return i(t)?"":" extends "+e.map(t,h).join(" & ")};var v=function(e){return e.typeName+d(e.bounds)};var m=function(e){return e.element.name+"="+e.value.toString};var g=function(t){return i(t)?"":"("+e.map(t,m).join(", ")+")"};var y=function(e){return"@"+h(e.annotationType)+g(e.elementValues)};var b=function(t){return i(t)?"":e.map(t,y).join(" ")+" "};var w=function(e){return b(e.annotations)+h(e.type)+" "+e.name};var E=function(t){return i(t)?"":"&lt;"+e.map(t,v).join(", ")+"&gt;"};var S=function(t){return e.map(t,w).join(", ")};var x=new RegExp("\\[\\](.*&gt;)?");var T=function(e){return e.replace(x,"$1...")};var N=function(t,n){if(n.indexOf("...")>0){var r=e.map(t,w);r[r.length-1]=T(e.last(r));return r.join(", ")}else{return S(t)}};var C=function(t){return i(t)?"":"throws "+e.map(t,h).join(", ")};var k=function(e,t){if(e.text.indexOf("<")==0){return e.text}else{return A(e,n.getPackageFor(t).name,n.getClassFor(t).name)}};var L=/^\s*([^\s#]*)(#([^\s()]*)(\(.*?\))?)?(\s+\S.*)?/;var A=function(e,t,n){return"<span class='code'>"+O(e,t,n)+"</span>"};var O=function(e,t,n){var i=L.exec(e.text);if(i==null){return e.text}var o=M(i,t,n);var u=i[5]||i[0].replace("#",".");r.log(s,"Formatter.formatLinkplainTag: "+JSON.stringify(e)+"; ref: "+o);return"<a href='#/q/java/qn/"+o+"'>"+u+"</a>"};var M=function(e,t,n){var r=e[1];if(i(r)){r=t+"."+n}else if(r.indexOf(".")<0){r=t+"."+r}var s=e[3];var o=e[4];if(!i(o)){o=_(o)}return i(s)?r:r+"+"+s+(o||"")};var _=function(t){if(t.length<=2){return t}var n="("+e.map(t.substring(1,t.length-1).split(","),function(e){return e.trim().split(" ")[0]}).join(",")+")";r.log(s,"formatLinkTagMethodParms: "+t+" --> "+n);return n};var D=function(e){var t=angular.element("<div />");t.text(e);return t.html()};var P=function(e){return"<code>"+H(e)+"</code>"};var H=function(e){return D(e.text)};var B=function(e,t,n){switch(e.name){case"@code":return P(e);case"@docRoot":return"{@docRoot "+e.text+"}";case"@inheritDoc":return"{@inheritDoc}";case"@link":return A(e,t,n);case"@linkplain":return O(e,t,n);case"@literal":return H(e);case"@value":return"{@value "+e.text+"}";default:return e.text}};var j=function(t,n,r){return e.map(t,function(e){return B(e,n,r)}).join("")};var F={};F.formatType=h;F.formatTypeParameters=E;F.formatTypeParameter=v;F.formatMethodSignature=N;F.formatSeeTag=k;F.formatInlineTag=B;F.formatInlineTags=j;F.formatAnnotation=y;return F}]).factory("Log",function(){var e=function(e,t){if(e.logging){var n=e.logging.prefix?e.logging.prefix+": ":"";console.log(n+t)}};return{log:e}}).service("Utils",["_",function(e){var t="";var n=function(t){return e.isUndefined(t)||t==null||t.length==0};var r=function(e,n){t=decodeURIComponent(n)};var i=function(){return t};var s=/\#(.*)\//;var o=function(e){var t=s.exec(e);return t!=null?t[1]:null};this.isEmpty=n;this.setLocation=r;this.getPrevLocation=i;this.parseLibraryFromLocation=o}]).service("JavadocModelUtils",["Utils","_",function(e,t){var n=e.isEmpty;var r=["class","interface","annotationType","enum"];var i=["method","constructor","field","enumConstant"];var s=["method","constructor","annotationTypeElement"];var o=function(e){return!n(e)?e._id:null};var u=function(e){return e.name||e.typeName};var a=function(e){return u(e)+(e.dimension||"")};var f=function(e){return e.qualifiedName||e.qualifiedTypeName||e.name};var l=function(e){return"("+t.chain(e.parameters).pluck("type").pluck("qualifiedTypeName").value().join(",")+")"};var c=function(e){switch(h(e)){case"field":case"enumConstant":case"annotationTypeElement":return f(e).replace(new RegExp("[.]"+e.name+"$"),"+"+e.name);case"method":case"constructor":return f(e).replace(new RegExp("[.]"+e.name+"$"),"+"+e.name)+l(e);default:return f(e)}};var h=function(e){return!n(e)?e.metaType:null};var p=function(e){return"interface"==h(e)};var d=function(e){return t.contains(r,h(e))};var v=function(e){return t.contains(s,h(e))};var m=function(e){return t.contains(i,h(e))};var g=function(e){return h(e)=="package"};var y=function(e){return h(e)=="library"};var b=function(e){return h(e)=="library.versions"};var w=function(e){return h(e)=="lang"};var E=function(e){return u(e)==f(e)};var S=function(e){return!(n(e.parameterizedType)&&n(e.wildcardType))};var x=function(e){return E(e)&&n(e.bounds)};var T=function(e){return g(e)?e._id:o(e.containingPackage)};var N=function(e){return y(e)?e._id:o(e._library)};var C=function(e){return d(e)?e:e.containingClass||{}};var k=function(e){return g(e)?e:e.containingPackage};var L=function(e){switch(e.kind){case"@see":case"@param":case"@throws":case"@exception":case"@return":return false;default:return true}};var A=function(e){return t.filter(e,L)};this.getId=o;this.getMetaType=h;this.getPackageId=T;this.getLibraryId=N;this.getClassFor=C;this.getPackageFor=k;this.getQualifiedName=f;this.getName=u;this.getNameAndDimension=a;this.isMethod=v;this.isInterface=p;this.isClass=d;this.isClassElement=m;this.isPackage=g;this.isLibrary=y;this.isLibraryVersions=b;this.isLang=w;this.getUnformattedTags=A;this.getReferenceName=c;this.isPrimitiveType=E;this.isParameterizedType=S;this.isSimpleTypeParameter=x}]).service("ViewModelService",["_",function(e){this.transform=function(e){return e};this.getScopeName=function(e){if(e.metaType=="constructor"){return"methodDoc"}else if(e.metaType=="interface"){return"classDoc"}else if(e.metaType=="enum"){return"classDoc"}else if(e.metaType=="annotationType"){return"classDoc"}else if(e.metaType=="enumConstant"){return"fieldDoc"}else{return e.metaType+"Doc"}}}]).service("ReferenceQueryService",["DbService","JavadocModelUtils","$location","$window","$modal","Utils","_","Log",function(e,t,n,r,i,s,o,u){var a=function(e){var t=i.open({templateUrl:"partials/modal-message.html",controller:"ModalMessageController",resolve:{message:function(){return"Sorry! Couldn't find <b>"+e.replace("+",".")+"</b> in the database."+" Perhaps the package is wrong?? Try searching for the class name."},title:function(){return"Not Found"}}})};var f=function(e){var t=i.open({templateUrl:"partials/modal-reference-query-results.html",controller:"ModalReferenceQueryResultsController",size:"lg",resolve:{models:function(){return e}}});t.result.then(function(e){n.hash(e._id).replace()},function(){r.history.back()})};var l=function(e,n){return t.getLibraryId(e)==n};var c=function(e){var t=s.parseLibraryFromLocation(s.getPrevLocation());var n=o.filter(e,function(e){return l(e,t)});u.log(this,"filterModels: libraryId: "+t+"; filteredModels: "+JSON.stringify(n,undefined,2));return!s.isEmpty(n)?n:e};var h=function(e,t){u.log(this,"success: "+JSON.stringify(e,undefined,2));e=c(e);if(e.length==1){n.hash(e[0]._id).replace()}else if(e.length==0){r.history.back();a(t)}else{f(e)}};var p=function(t,n){u.log(this,"getReferenceType: "+t);var r=t.substring("/q/java/qn/".length);u.log(this,"getReferenceType: referenceName: "+r);e.getQuietly(t).success(function(e){h(e,r)})};var d=function(t){u.log(this,"resolveFirstId: "+t);var n="/q/java/qn/"+t;return e.getQuietly(n).then(function(e){var t=e.data;return t.length>0?t[0]._id:null})};this.getReferenceType=p;this.resolveFirstId=d}]).controller("ModalMessageController",["$scope","$modalInstance","message","title",function(e,t,n,r){e.message=n;e.title=r;e.ok=function(){t.close()}}]).controller("ModalReferenceQueryResultsController",["$scope","$modalInstance","models",function(e,t,n){e.models=n;e.cancel=function(){t.dismiss("cancel")}}]).controller("SearchController",["$scope","AutoCompleteService","Utils","JavadocModelUtils","Log",function(e,t,n,r,i){var s=this;s.onChangeCounter=0;var o=function(r,o){i.log(s,"callAutoCompleteService:  str=#"+r+"#, autoCompleteIndexName: "+e.autoCompleteIndexName+", onChangeCount: "+o+", onChangeCounter: "+s.onChangeCounter);t.get(r,e.autoCompleteIndexName).success(function(t){if(s.onChangeCounter==o&&!n.isEmpty(e.str)){e.autoCompleteData=t}else{i.log(s,"AutoCompleteService.get.success: onChangeCount ("+o+") != onChangeCounter ("+s.onChangeCounter+")")}})};var u=function(){e.autoCompleteData=[];e.str=""};var a=function(t){i.log(s,"onKeypress: keycode: "+t.keyCode+", $scope.str: "+e.str);if(t.keyCode==27){u()}};var f=function(){++s.onChangeCounter;i.log(s,"onChange: $scope.str: "+e.str+", onChangeCounter: "+s.onChangeCounter);if(n.isEmpty(e.str)){u()}else{o(e.str,s.onChangeCounter)}};e.clearListing=u;e.onKeypress=a;e.onChange=f;e.getReferenceName=r.getReferenceName}]).controller("JavadocController",["$scope","$rootScope","$location","DbService","ViewModelService","Utils","Formatter","ReferenceQueryService","JavadocModelUtils","Log",function(e,t,n,r,i,s,o,u,a,f){var l=this;var c=function(t){e.requestPending=t};e.$watch(function(){return n.hash()},function(e){if(s.isEmpty(e)){h("/java")}else if(e.indexOf("/java")==0){h(e)}else if(e.indexOf("/q/java/qn/")==0){c(true);u.getReferenceType(e)}});e.Formatter=o;e.JavadocModelUtils=a;t.isEmpty=s.isEmpty;var h=function(t){p();c(true);r.get(t).success(function(t){e.javadocModel=t;e[i.getScopeName(t)]=i.transform(t)}).finally(function(){c(false)})};var p=function(){document.body.scrollTop=document.documentElement.scrollTop=0}}]).controller("AllKnownSubclassesController",["$scope","$rootScope","DbService","JavadocModelUtils","_",function(e,t,n,r,i){e.allKnownSubclasses=[];var s=function(e){return"/q/java/allKnownSubclasses/"+r.getQualifiedName(e)};var o=function(t){e.allKnownSubclasses=[];n.getQuietly(s(t||e.javadocModel)).success(function(t){i.map(t,function(e){e._id=null;return e});e.allKnownSubclasses=t;e.none=t.length==0})};t.$on("$saJavadocModelChange",function(e,t){o(t)});o()}]).controller("AllKnownImplementorsController",["$scope","$rootScope","DbService","JavadocModelUtils","_",function(e,t,n,r,i){e.allKnownImplementors=[];var s=function(e){return"/q/java/allKnownImplementors/"+r.getQualifiedName(e)};var o=function(t){e.allKnownImplementors=[];n.getQuietly(s(t||e.javadocModel)).success(function(t){i.map(t,function(e){e._id=null;return e});e.allKnownImplementors=t;e.none=t.length==0})};t.$on("$saJavadocModelChange",function(e,t){o(t)});o()}]).controller("MethodController",["$scope","DbService","ViewModelService","_","Utils","JavadocModelUtils","ReferenceQueryService",function(e,t,n,r,i,s,o){var u=function(){return r.isUndefined(e.fieldDoc)?e.methodDoc:e.fieldDoc};var a=function(){return u()._id};var f=function(e){return unescape(location.hash)=="#"+e};var l=function(r){if(f(r)){return}e.showFullDocToggle=!e.showFullDocToggle;if(e.showFullDocToggle){t.getQuietly(r).success(function(t){e[n.getScopeName(t)]=n.transform(t);e.model=t})}};e.showFullDoc=function(){var e=a();if(!i.isEmpty(e)){l(e)}else{o.resolveFirstId(s.getReferenceName(u())).then(l)}};if(f(a())){e.showFullDocToggle=true}}]).controller("NavPathBarController",["$scope","$rootScope","JavadocModelUtils","Utils","Log",function(e,t,n,r,i){var s=this;t.$on("$locationChangeSuccess",function(e,t,n){i.log(s,"$locationChangeSuccess: newUrl: "+t+"; oldUrl: "+n);r.setLocation(t,n)});t.$on("$saJavadocModelChange",function(t,r){i.log(s,"$saJavadocModelChange: _id: "+n.getId(r));switch(n.getMetaType(r)){case"package":e.anchors=f(r);break;case"library":e.anchors=a(r);break;case"library.versions":e.anchors=u(r);break;case"lang":e.anchors=o(r.name);break;case null:e.anchors=[{html:"error: null",href:"/"}];break;default:e.anchors=l(r);break}});var o=function(e){return[{html:e,href:"#/"+e}]};var u=function(e){var t=o(e.lang);t.push({html:e.name,href:"#/"+e.lang+"/"+e.name});return t};var a=function(e){var t=u(e);t.push({html:e.version,href:"#"+e._id});return t};var f=function(e){var t=a(e._library);t.push({html:e.name,href:"#"+e._id});return t};var l=function(e){var t=a(e._library);t.push({html:e.containingPackage.name,href:"#"+e.containingPackage._id});if(!r.isEmpty(e.containingClass)){t.push({html:e.containingClass.name,href:"#"+e.containingClass._id})}t.push({html:e.name,href:"#"+e._id});return t}}]).controller("NavLibraryController",["$scope","$rootScope","JavadocModelUtils","DbService","Log",function(e,t,n,r,i){var s=this;var o=null;var u=null;t.$on("$saJavadocModelChange",function(e,t){i.log(s,"$saJavadocModelChange: _id: "+n.getId(t));switch(n.getMetaType(t)){case"package":a(t);l(n.getLibraryId(t));break;case"library":f(t);h();break;case"lang":case"library.versions":case null:p();break;default:l(n.getLibraryId(t));c(n.getPackageId(t))}});var a=function(t){u=t!=null?t._id:null;e.packageModel=t};var f=function(t){o=t!=null?t._id:null;e.libraryModel=t;e.autoCompleteIndexName=e.libraryModel._id};var l=function(e){i.log(s,"refreshLibrary: current/new: "+o+", "+e);if(e!=o){r.getQuietly(e).success(f)}};var c=function(e){if(e!=u){r.getQuietly(e).success(a)}};var h=function(){e.packageModel=null;u=null};var p=function(){h();e.libraryModel=null;e.autoCompleteIndexName=null;o=null}}]).filter("prettyPrintJson",function(){return function(e){return angular.toJson(e,true)}}).filter("trim",function(){return function(e,t){return e?e.replace(new RegExp(t+"\\s*$"),""):""}}).filter("formatTags",["Formatter","_","Utils","JavadocModelUtils",function(e,t,n,r){var i=/\{(\@[^\s\}]+)(?:\s*)?([^\}]*)?\}/g;var s=function(e){var t=[];var n;while(n=i.exec(e)){t.push({fullText:n[0],name:n[1],text:n[2]})}return t};var o=function(n,i){var o=t.map(s(n),function(t){t.formattedText=e.formatInlineTag(t,r.getPackageFor(i).name,r.getClassFor(i).name);return t});return t.reduce(o,function(e,t){return e.replace(t.fullText,t.formattedText)},n)};return function(e,t){return n.isEmpty(e)?e:o(e,t)}}]).filter("formatInlineTags",["Formatter",function(e){return function(t,n,r){return e.formatInlineTags(t,n,r)}}]).filter("reverse",function(){return function(e){return e!=null?e.slice().reverse():null}}).filter("otherBlockTags",["_",function(e){var t=function(e){switch(e.kind){case"@see":case"@param":case"@throws":case"@exception":case"@return":return false;default:return true}};return function(n){return n!=null?e.filter(n,t):null}}]).directive("saType",["$compile","Formatter","JavadocModelUtils","Log",function(e,t,n,r){var i=this;r.log(i,"ctor: ");var s=e("<span>{{nameAndDimension}}</span>");var o=e("<span><a href='#/q/java/qn/{{referenceName}}'>{{nameAndDimension}}</a>");var u=function(e,t){e.nameAndDimension=n.getNameAndDimension(e.typeDoc);s(e,function(e,n){t.replaceWith(e)})};var a=function(e,t){e.nameAndDimension=n.getNameAndDimension(e.typeDoc);e.referenceName=n.getReferenceName(e.typeDoc);o(e,function(e,n){t.replaceWith(e)})};var f=function(n,r){e("<span>"+t.formatType(n.typeDoc)+"</span>")(n,function(e,t){r.replaceWith(e)})};var l=function(e,t,r){if(angular.isDefined(e.typeDoc)){if(n.isPrimitiveType(e.typeDoc)){u(e,t)}else if(!n.isParameterizedType(e.typeDoc)){a(e,t)}else{f(e,t)}}};return{restrict:"E",scope:{typeDoc:"=doc"},link:l}}]).directive("saTypeParameter",["$compile","Formatter","JavadocModelUtils",function(e,t,n){var r=function(e){};var i=e("<span>{{typeParameter.typeName}}</span>");var s=function(e,t){r("linkSimpleType: "+e.typeParameter.typeName);i(e,function(e,n){t.replaceWith(e)})};var o=function(n,i){r("linkComplexType: "+n.typeParameter.typeName);e("<span>"+t.formatTypeParameter(n.typeParameter)+"</span>")(n,function(e,t){i.replaceWith(e)})};var u=function(e,t,r){if(angular.isDefined(e.typeParameter)){if(n.isSimpleTypeParameter(e.typeParameter)){s(e,t)}else{o(e,t)}}};return{restrict:"E",scope:{typeParameter:"=doc"},link:u}}]).directive("saTypeParameters",["$compile","Formatter",function(e,t){var n=function(e){};var r=e("<span></span>");var i=e("<span>&lt;<sa-type-parameter doc='typeParameters[0]'></sa-type-parameter>&gt;</span>");var s=e("<span>&lt;"+"<sa-type-parameter doc='typeParameters[0]'></sa-type-parameter>, "+"<sa-type-parameter doc='typeParameters[1]'></sa-type-parameter>"+"&gt;</span>");var o=function(e,t){n("linkNoTypeParameters: ");r(e,function(e,n){t.replaceWith(e);n.element=e})};var u=function(e,t){n("linkSingleTypeParameter: ");i(e,function(e,n){t.replaceWith(e);n.element=e})};var a=function(e,t){n("linkDoubleTypeParameter: ");s(e,function(e,n){t.replaceWith(e);n.element=e})};var f=function(r,i){n("linkManyTypeParameters: ");var s="<span>"+t.formatTypeParameters(r.typeParameters)+"</span>";e(s)(r,function(e,t){i.replaceWith(e);t.element=e})};var l=function(e,r,i){if(angular.isDefined(e.typeParameters)){e.element=r;e.$watch("typeParameters",function(){n("linkFn.watch: "+t.formatTypeParameters(e.typeParameters));if(e.typeParameters.length==0){o(e,e.element)}else if(e.typeParameters.length==1){u(e,e.element)}else if(e.typeParameters.length==2){a(e,e.element)}else{f(e,e.element)}})}};return{restrict:"E",scope:{typeParameters:"=doc"},link:l}}]).directive("saMethodSignature",["$compile","Formatter",function(e,t){var n=function(e){};var r=e("<span>()</span>");var i=e("<span>(<sa-type doc='parameters[0].type'></sa-type> {{parameters[0].name}})</span>");var s=function(e,t){n("linkNoParameters: ");r(e,function(e,n){t.replaceWith(e)})};var o=function(e,t){n("linkSingleParameter: ");i(e,function(e,n){t.replaceWith(e)})};var u=function(r,i){n("linkMultipleParameters: "+r.flatSignature);var s="<span>("+t.formatMethodSignature(r.parameters,r.flatSignature)+")</span>";e(s)(r,function(e,t){i.replaceWith(e)})};var a=function(e,t,n){if(angular.isDefined(e.parameters)){if(e.parameters.length==0){s(e,t)}else if(e.parameters.length==1){o(e,t)}else{u(e,t)}}};return{restrict:"E",scope:{parameters:"=",flatSignature:"="},link:a}}]).factory("_",function(){return window._})
